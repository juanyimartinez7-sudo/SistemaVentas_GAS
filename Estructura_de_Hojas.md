
# Estructura de la Base de Datos en Google Sheets

Este documento describe la estructura de cada hoja de cálculo que el sistema de ventas utiliza. El script `Code.gs` creará estas hojas automáticamente si no existen al abrir el documento por primera vez.

---

### Tabla de Hojas y Columnas

| Hoja                | Columnas                                                                                                                                                                                            | Descripción                                                                                                             |
| ------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| **CONFIG_EMPRESA**  | `id`, `nombre`, `tipo_doc`, `numero_doc`, `regimen`, `direccion`, `telefono`, `correo`, `creado_en`, `actualizado_en`                                                                                   | Almacena los datos de la empresa que emite las facturas. Solo debería tener una fila.                                     |
| **USUARIOS**        | `id`, `nombre`, `cedula`, `correo`, `telefono`, `rol`, `permisos_json`, `password_hash`, `activo`, `creado_por`, `creado_en`, `actualizado_en`                                                             | Gestiona los usuarios del sistema, sus roles, permisos y credenciales.                                                  |
| **CLIENTES**        | `id`, `codigo`, `nombre`, `tipo_doc`, `doc`, `tipo_ncf`, `telefono`, `direccion`, `correo`, `creado_por`, `creado_en`, `actualizado_en`                                                                   | Base de datos de clientes. El `codigo` es un identificador único autogenerado.                                          |
| **PRODUCTOS**       | `id`, `nombre`, `precio`, `activo`, `creado_por`, `creado_en`, `actualizado_en`                                                                                                                         | Catálogo de productos o servicios con sus precios.                                                                      |
| **NCF_SERIES**      | `id`, `tipo`, `nombre`, `prefijo`, `rango_desde`, `rango_hasta`, `cantidad_autorizada`, `usados`, `restantes`, `vence_el`, `habilitado`, `historico_json`, `creado_por`, `creado_en`                     | Control de las secuencias de Números de Comprobante Fiscal (NCF).                                                       |
| **COTIZACIONES**    | `id`, `numero`, `cliente_id`, `items_json`, `subtotal`, `itbis`, `total`, `estado`, `creado_por`, `creado_en`, `actualizado_en`                                                                            | Registro de todas las cotizaciones generadas. `items_json` contiene el detalle de productos.                           |
| **FACTURAS**        | `id`, `ncf`, `cotizacion_id`, `cliente_id`, `fecha`, `subtotal`, `itbis`, `total`, `estado`, `creado_por`, `creado_en`, `anulado_por`, `anulado_en`                                                         | Registro de todas las facturas emitidas, generadas a partir de cotizaciones.                                           |
| **PAGOS**           | `id`, `factura_id`, `fecha`, `forma_pago`, `banco`, `referencia`, `monto_pagado`, `ret_itbis`, `ret_isr`, `neto_recibido`, `edit_motivo_json`, `creado_por`, `creado_en`, `actualizado_en`                 | Registra los pagos recibidos para cada factura, incluyendo retenciones.                                                 |
| **607**             | `id`, `fecha`, `rnc_cedula`, `tipo_ingreso`, `ncf`, `fecha_retencion`, `monto`, `itbis`, `itbis_retenido`, `isr_retenido`, `forma_pago`, `origen_factura_id`                                              | Datos para la generación del reporte 607 (Ventas y Operaciones). Se genera al facturar.                                  |
| **608**             | `id`, `ncf`, `fecha`, `motivo`, `reutilizado`, `origen_factura_id`, `anulado_por`                                                                                                                          | Datos para la generación del reporte 608 (Comprobantes Anulados). Se genera al anular una factura.                       |
| **RESPALDOS**       | `id`, `tipo`, `detalle`, `archivo_id`, `creado_por`, `creado_en`                                                                                                                                          | Historial de respaldos (exportaciones e importaciones) realizados en el sistema.                                        |
| **LOG_ACTIVIDAD**   | `id`, `timestamp`, `usuario_id`, `accion`, `modulo`, `detalle_json`                                                                                                                                     | Bitácora de todas las acciones importantes realizadas en el sistema para auditoría.                                     |
